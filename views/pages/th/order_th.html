{{ define "content" }}
    <script>function handleMarketspaceChange() {
        const marketspaceSelect = document.querySelector('#marketspace');
        const deliveryTermSelect = document.querySelector('#delivery_term_id');
        const selectedMarketspace = marketspaceSelect.value;
        const selectedDeliveryTerm = deliveryTermSelect ? deliveryTermSelect.value : '';
        const portFields = document.getElementById('port-fields');
        const locationFields = document.getElementById('location-fields');
        
        function resetFields(fieldsContainer, fieldIds) {
            if (fieldsContainer) {
                fieldsContainer.style.display = 'none';
                fieldIds.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.removeAttribute('required');
                        if (element.tagName === 'SELECT') {
                            element.selectedIndex = 0;
                        } else {
                            element.value = '';
                        }
                    }
                });
            }
        }
        
        // Reset all fields first
        resetFields(portFields, ['POL', 'POD']);
        resetFields(locationFields, ['province_id', 'district_id', 'subdistrict_id']);
        
        // Apply requirements based on conditions
        if (selectedMarketspace === '1') { // Local market
            locationFields.style.display = 'block';
            ['province_id', 'district_id', 'subdistrict_id'].forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.setAttribute('required', '');
                }
            });
        } else if (selectedMarketspace === '2') { // Global market
            if (selectedDeliveryTerm === '5' || selectedDeliveryTerm === '9') {
                locationFields.style.display = 'block';
                ['province_id', 'district_id', 'subdistrict_id'].forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.setAttribute('required', '');
                    }
                });
            } else {
                portFields.style.display = 'block';
                // Remove required attribute for POL/POD as we'll handle it in validation
                ['POL', 'POD'].forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.removeAttribute('required');
                    }
                });
            }
        }
    }
    
    function validateFields() {
    const marketspaceSelect = document.querySelector('#marketspace');
    const deliveryTermSelect = document.querySelector('#delivery_term_id');
    const selectedMarketspace = marketspaceSelect.value;
    const selectedDeliveryTerm = deliveryTermSelect ? deliveryTermSelect.value : '';
    
    let invalidFields = [];

    // üîπ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ü‡∏¥‡∏•‡∏î‡πå Default Form Fields ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏™‡∏°‡∏≠
    const requiredFields = [
        'market', 'submarket', 'orderType', 'matchingType', 'contractType',
        'product', 'quality' ,'price','currency', 'quantity', 'uom_id', 
        'packing_id', 'payment_term_id','country_id', 'first_delivery_date', 'last_delivery_date'
    ];

    requiredFields.forEach(id => {
        const element = document.getElementById(id);
        if (element && !element.value) {
            invalidFields.push(element.previousElementSibling.textContent.replace(':', ''));
        }
    });

    // üîπ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Location Fields ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Local Market
    if (selectedMarketspace === '1') {
        ['province_id', 'district_id', 'subdistrict_id'].forEach(id => {
            const element = document.getElementById(id);
            if (element && !element.value) {
                invalidFields.push(element.previousElementSibling.textContent.replace(':', ''));
            }
        });
    }
    // üîπ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Location ‡∏´‡∏£‡∏∑‡∏≠ Port Fields ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Global Market
    else if (selectedMarketspace === '2') {
        if (selectedDeliveryTerm === '5' || selectedDeliveryTerm === '9') {
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ ‡∏ï‡∏≥‡∏ö‡∏•
            ['province_id', 'district_id', 'subdistrict_id'].forEach(id => {
                const element = document.getElementById(id);
                if (element && !element.value) {
                    invalidFields.push(element.previousElementSibling.textContent.replace(':', ''));
                }
            });
        } else {
            // ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô POL ‡∏´‡∏£‡∏∑‡∏≠ POD ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏Ñ‡πà‡∏≤
            const pol = document.getElementById('POL');
            const pod = document.getElementById('POD');
            if ((!pol?.value && !pod?.value)) {
                invalidFields.push('At least one port (Port of Loading or Port of Discharge) is required');
            }
        }
    }

    return invalidFields;
}

    
    function generateConfirmation() {
        const form = document.querySelector('form');
    
        try {
            // Original confirmation generation code remains the same
            const marketspace = form.querySelector('#marketspace option:checked')?.textContent || '';
            const deliveryTerm = form.querySelector('#delivery_term_id option:checked')?.textContent || '';
            const market = form.querySelector('#market option:checked')?.textContent || '';
            const submarket = form.querySelector('#submarket option:checked')?.textContent || '';
            const orderType = form.querySelector('#orderType option:checked')?.textContent || '';
            const matchingType = form.querySelector('#matchingType option:checked')?.textContent || '';
            const contractType = form.querySelector('#contractType option:checked')?.textContent || '';
            const product = form.querySelector('#product option:checked')?.textContent || '';
            const quality = form.querySelector('#quality option:checked')?.textContent || '';
            const price = form.querySelector('#price')?.value || '';
            const currency = form.querySelector('#currency option:checked')?.textContent || '';
            const quantity = form.querySelector('#quantity')?.value || '';
            const uom = form.querySelector('#uom_id option:checked')?.textContent || '';
            const packing = form.querySelector('#packing_id option:checked')?.textContent || '';
            const paymentTerm = form.querySelector('#payment_term_id option:checked')?.textContent || '';
            const country = form.querySelector('#country_id option:checked')?.textContent || '';
            const port_of_loading = form.querySelector('#POL option:checked')?.textContent || '';
            const port_of_discharge = form.querySelector('#POD option:checked')?.textContent || '';
            const province = form.querySelector('#province_id option:checked')?.textContent || '';
            const district = form.querySelector('#district_id option:checked')?.textContent || '';
            const subdistrict = form.querySelector('#subdistrict_id option:checked')?.textContent || '';
            const firstDeliveryDate = form.querySelector('#first_delivery_date')?.value || '';
            const lastDeliveryDate = form.querySelector('#last_delivery_date')?.value || '';
            const remark = form.querySelector('#remark')?.value || '';
    
            let confirmationDetails = `
            <div class="modal-header">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÄ‡∏™‡∏ô‡∏≠‡∏ã‡∏∑‡πâ‡∏≠/‡πÄ‡∏™‡∏ô‡∏≠‡∏Ç‡∏≤‡∏¢</div>
            <ul>
                <li><b>‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡∏ï‡∏•‡∏≤‡∏î:</b> ${marketspace}</li>
                <li><b>‡∏ï‡∏•‡∏≤‡∏î‡∏´‡∏•‡∏±‡∏Å:</b> ${market}</li>
                <li><b>‡∏ï‡∏•‡∏≤‡∏î‡∏¢‡πà‡∏≠‡∏¢:</b> ${submarket}</li>
                <li><b>‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏ô‡∏≠:</b> ${orderType}</li>
                <li><b>‡∏≠‡∏±‡∏•‡∏Å‡∏≠‡∏£‡∏¥‡∏ó‡∏∂‡∏°‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà:</b> ${matchingType}</li>
                <li><b>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏±‡∏ç‡∏ç‡∏≤:</b> ${contractType}</li>
                <li><b>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</b> ${product}</li>
                <li><b>‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û:</b> ${quality}</li>
                <li><b>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢:</b> ${price}</li>
                <li><b>‡∏™‡∏Å‡∏∏‡∏•‡πÄ‡∏á‡∏¥‡∏ô:</b> ${currency}</li>
                <li><b>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô:</b> ${quantity}</li>
                <li><b>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ô‡∏±‡∏ö:</b> ${uom}</li>
                <li><b>‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏£‡∏à‡∏∏:</b> ${packing}</li>
                <li><b>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô:</b> ${paymentTerm}</li>
                <li><b>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö:</b> ${deliveryTerm}</li>
                <li><b>‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®:</b> ${country}</li>`;
    
            const marketspaceValue = form.querySelector('#marketspace').value;
            const deliveryTermValue = form.querySelector('#delivery_term_id').value;
    
            if (marketspaceValue === '2' && (deliveryTermValue === '5' || deliveryTermValue === '9')) {
                confirmationDetails += `
                    <li><b>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î:</b> ${province}</li>
                    <li><b>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠:</b> ${district}</li>
                    <li><b>‡∏ï‡∏≥‡∏ö‡∏•:</b> ${subdistrict}</li>
                `;
            } else if (marketspaceValue === '2') {
                // Show only filled port fields
                if (port_of_loading) {
                    confirmationDetails += `<li><b>‡∏ó‡πà‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á:</b> ${port_of_loading}</li>`;
                }
                if (port_of_discharge) {
                    confirmationDetails += `<li><b>‡∏ó‡πà‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á:</b> ${port_of_discharge}</li>`;
                }
            } else if (marketspaceValue === '1') {
                confirmationDetails += `
                    <li><b>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î:</b> ${province}</li>
                    <li><b>‡∏≠‡∏≥‡πÄ‡∏†‡∏≠:</b> ${district}</li>
                    <li><b>‡∏ï‡∏≥‡∏ö‡∏•:</b> ${subdistrict}</li>
                `;
            }
    
            confirmationDetails += `
                <li><b>‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö:</b> ${firstDeliveryDate}</li>
                <li><b>‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö:</b> ${lastDeliveryDate}</li>
                <li><b>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏(‡∏ñ‡πâ‡∏≤‡∏°‡∏µ):</b> ${remark}</li>
            </ul>
            <div class="modal-footer">
                <button onclick="submitForm()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á</button>
                <button type="button" onclick="closeModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            </div>`;
    
            const modalContent = document.getElementById('modal-content');
            const confirmationModal = document.getElementById('confirmationModal');
            
            if (modalContent && confirmationModal) {
                modalContent.innerHTML = confirmationDetails;
                confirmationModal.style.display = 'block';
            } else {
                console.error('Modal elements not found');
            }
        } catch (error) {
            console.error('Error in generateConfirmation:', error);
        }
    }
    
    function closeModal() {
        document.getElementById('confirmationModal').style.display = 'none';
    }
    
    function submitForm() {
    const invalidFields = validateFields();
    if (invalidFields.length > 0) {
        alert('Please fill in the following required fields:\n' + invalidFields.join('\n'));
        return; // ‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏° ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö
    }
    const form = document.querySelector('form');
    form.submit();
}

    
    document.addEventListener('DOMContentLoaded', function() {
        const marketspaceSelect = document.querySelector('#marketspace');
        const deliveryTermSelect = document.querySelector('#delivery_term_id');
        let lastKnownMarketspace = "";
        
        if (marketspaceSelect) {
            marketspaceSelect.addEventListener('change', () => {
                const changingToGlobal = lastKnownMarketspace === "1" && marketspaceSelect.value === "2";
                lastKnownMarketspace = marketspaceSelect.value;
                
                if (changingToGlobal && (deliveryTermSelect.value === '5' || deliveryTermSelect.value === '9')) {
                    deliveryTermSelect.value = "";
                    deliveryTermSelect.dispatchEvent(new Event('change'));
                }
                
                handleMarketspaceChange();
            });
            lastKnownMarketspace = marketspaceSelect.value;
        }
        
        if (deliveryTermSelect) {
            deliveryTermSelect.addEventListener('change', () => {
                handleMarketspaceChange();
            });
        }
        
        setTimeout(handleMarketspaceChange, 100);
    });
</script>
<nav class="vertical-nav">
    <a href="/?lang={{ .lang }}" class="vertical-nav-brand">BiomassX</a>
    <div class="vertical-nav-menu">
        <a href="/dashboard?lang={{ .lang }}" class="nav-item">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</a>
        <span class="nav-category">‡πÄ‡∏™‡∏ô‡∏≠‡∏ã‡∏∑‡πâ‡∏≠/‡πÄ‡∏™‡∏ô‡∏≠‡∏Ç‡∏≤‡∏¢</span>
        <a href="/order?lang={{ .lang }}" class="nav-item">&nbsp;&nbsp;&nbsp;‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a>
        <a class="nav-subcategory">&nbsp;&nbsp;&nbsp;‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</a>
        <a class="nav-subcategory">&nbsp;&nbsp;&nbsp;‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</a>
        
        <span class="nav-category">‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏¢</span>
        <a href="/contract?lang={{ .lang }}" class="nav-item">&nbsp;&nbsp;&nbsp;‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a>
        <a class="nav-subcategory">&nbsp;&nbsp;&nbsp;‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</a>
        <a class="nav-subcategory">&nbsp;&nbsp;&nbsp;‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</a>
        
        <span class="nav-category">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</span>
        <a href = "/profile?lang={{ .lang }}" class="nav-subcategory">&nbsp;&nbsp;&nbsp;‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</a>
        <br>
        <a href="/logout?lang={{ .lang }}" hx-post="/logout?lang={{ .lang }}" hx-redirect="/login?lang={{ .lang }}" class="nav-item">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</a>
    </div>
</nav>

<body>
    <div class="content-wrapper">
        <main class="main-dashboard main-with-vertical-nav">
            <form hx-post="/order" hx-target="#response" hx-swap="innerHTML" method="post">
                <h2>‡πÄ‡∏™‡∏ô‡∏≠‡∏ã‡∏∑‡πâ‡∏≠/‡πÄ‡∏™‡∏ô‡∏≠‡∏Ç‡∏≤‡∏¢ (‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤)</h2>
              <div class="form-group">
                <label for="marketspace_id">‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡∏ï‡∏•‡∏≤‡∏î:</label>
                <select id="marketspace" name="marketspaceID" hx-get="/payment?lang=th" 
                hx-trigger="change" 
                hx-target="#payment_term_id"
                hx-include="[name='marketspaceID']"
                hx-swap="innerHTML"
                hx-on="htmx:afterRequest: this.closest('form').querySelector('#delivery').dispatchEvent(new Event('change'));" >
                    <option value="">--select local/global market--</option>
                    {{range .Marketspaces}}<option value="{{.ID}}">{{.ThName}}</option>{{end}}
                </select></div><br>

                <div class="form-group">
                    <label for="market">‡∏ï‡∏•‡∏≤‡∏î‡∏´‡∏•‡∏±‡∏Å:</label>
                    <select id="market" name="marketID" 
                        hx-get="/submarkets?lang=th" 
                        hx-target="#submarket" 
                        hx-trigger="change"
                        hx-on::after-request="htmx.trigger('#submarket', 'change')"
                        required>
                        <option value="">--select a market--</option>
                        {{range .Markets}}<option value="{{.ID}}">{{.ThName}}</option>{{end}}
                    </select>
                </div><br>
                
                <div class="form-group">
                    <label for="submarket">‡∏ï‡∏•‡∏≤‡∏î‡∏¢‡πà‡∏≠‡∏¢:</label>
                    <select id="submarket" name="submarketID" 
                        hx-get="/products?lang=th" 
                        hx-target="#product" 
                        hx-trigger="change"
                        hx-on::after-request="htmx.trigger('#product', 'change')"
                        required>
                        <option value="">--select a submarket--</option>
                        {{range .Submarkets}}<option value="{{.ID}}">{{.ThName}}</option>{{end}}
                    </select>
                </div><br>
                
                <div class="form-group">
                <label for="order_type_id">‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏ô‡∏≠:</label>
                <select id="orderType" name="orderTypeID" hx-target="#orderType" hx-trigger="load" required>
                    <option value="">--select buy/sell order--</option>
                    {{range .OrderTypes}}<option value="{{.ID}}">{{.ThName}}</option>{{end}}
                </select></div><br>
                
                <div class="form-group">
                <label for="matching_type_id">‡∏≠‡∏±‡∏•‡∏Å‡∏≠‡∏£‡∏¥‡∏ó‡∏∂‡∏°‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà:</label>
                <select id="matchingType" name="matchingTypeID" hx-target="#matchingType" hx-trigger="load" required>
                    <option value="">--select a matching algorithm--</option>
                    {{range .MatchingTypes}}<option value="{{.ID}}">{{.ThName}}</option>{{end}}
                </select></div><br>

                <div class="form-group">
                <label for="contract_type_id">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏±‡∏ç‡∏ç‡∏≤:</label>
                <select id="contractType" name="contractTypeID" hx-target="#contractType" hx-trigger="load" required>
                    <option value="">--select a contract type--</option>
                    {{range .ContractTypes}}<option value="{{.ID}}">{{.ThName}}</option>{{end}}
                </select></div><br>
                

                <div class="form-group">
                    <label for="product">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</label>
                    <select id="product" name="productID" 
                        hx-get="/qualities" 
                        hx-target="#quality" 
                        hx-trigger="change"
                        required>
                        <option value="">--select a product--</option>
                        {{range .Products}}<option value="{{.ID}}">{{.EnName}}</option>{{end}}
                    </select>
                </div><br>
                
                <div class="form-group">
                    <label for="quality">‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û:</label>
                    <select id="quality" name="quality_id" required>
                        <option value="">--select a quality--</option>
                        {{range .Qualities}}<option value="{{.ID}}">{{.StandardID}},{{.GradeID}}</option>{{end}}
                    </select>
                </div><br>
                
                <div class="form-group">
                <label for="price">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢:</label>
                <input type="number" step="0.01" id="price" name="price" required></div><br>  
                
                <div class="form-group">
                    <label for="currency">‡∏™‡∏Å‡∏∏‡∏•‡πÄ‡∏á‡∏¥‡∏ô:</label>
                    <select id="currency" name="currency_id" >
                      <option value="">--select a currency--</option>
                      {{range .Currencies}}<option value="{{.ID}}">{{.Code}}</option>{{end}}
                    </select></div><br>
                
                <div class="form-group">
                <label for="quantity">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô:</label>
                <input type="number" step="0.01" id="quantity" name="quantity" required></div><br>
                
                <div class="form-group">
                <label for="uom_id">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ô‡∏±‡∏ö:</label>
                <select id="uom_id" name="uom_id" hx-target="#uom_id" hx-trigger="load" required>
                        <option value="">--select a unit--</option>
                        {{range .UomIDs}}<option value="{{.ID}}">{{.ThName}}</option>{{end}}
                    </select></div><br>
                
                <div class="form-group">
                <label for="packing_id">‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏£‡∏à‡∏∏:</label>
                <select id="packing_id" name="packing_id" hx-target="#packing_id" hx-trigger="load" required>
                    <option value="">--select a packing--</option>
                    {{range .PackingIDs}}<option value="{{.ID}}">{{.ThName}}</option>{{end}}
                </select></div><br>
                
                
                <div class="form-group">
                <label for="payment_term_id">‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô:</label>
                <select id="payment_term_id" name="payment_term_id" hx-get="/payment?lang=th" hx-trigger="change" required>
                    <option value="">--select a payment term--</option>
                    {{range .Payments}}<option value="{{.ID}}">{{.ThName}}</option>{{end}}
                </select></div><br>

                <div class="form-group">
                    <label for="delivery_term_id">‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö:</label>
                    <select id="delivery_term_id" name="delivery_term_id" hx-get="/delivery?lang=th"  hx-trigger="change from:#marketspace" hx-target="this" 
                    hx-include="[name='marketspaceID']" hx-swap="innerHTML" required>
                        <option value="">--select a delivery term--</option>
                        {{range .Deliverys}}<option value="{{.ID}}">{{.ThName}}</option>{{end}}
                    </select></div><br>

                    <div class="form-group">
                        <label for="country_id">‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®:</label>
                        <select id="country_id" name="country_id" hx-target="#country_id" hx-trigger="load" required>
                            <option value="">--select Countries--</option>
                            {{range .CountryIDs}}<option value="{{.ID}}">{{.EnName}}</option>{{end}}
                        </select></div><br>
                    
<!-- Location sections -->
<div id="location-fields">
    <div class="form-group">
        <label for="province_id">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î:</label>
        <select id="province_id" name="province_id" 
            hx-get="/district?lang=th" 
            hx-trigger="change" 
            hx-target="#district_id"
            hx-on::after-request="htmx.trigger('#district_id', 'change')">
            <option value="">--select a province/state--</option>
            {{range .Provinces}}<option value="{{.ID}}">{{.ThName}}</option>{{end}}
        </select>
    </div><br>
    
    <div class="form-group">
        <label for="district_id">‡∏≠‡∏≥‡πÄ‡∏†‡∏≠:</label>
        <select id="district_id" name="district_id" 
            hx-get="/subdistrict?lang=th" 
            hx-trigger="change" 
            hx-target="#subdistrict_id">
            <option value="">--select a district/city--</option>
            {{range .Districts}}<option value="{{.ID}}">{{.ThName}}</option>{{end}}
        </select>
    </div><br>
    
    <div class="form-group">
        <label for="subdistrict_id">‡∏ï‡∏≥‡∏ö‡∏•:</label>
        <select id="subdistrict_id" name="subdistrict_id" 
            hx-trigger="change from:#district_id">
            <option value="">--select a subdistrict--</option>
            {{range .Subdistricts}}<option value="{{.ID}}">{{.ThName}}</option>{{end}}
        </select>
    </div><br>
</div>

<div id="port-fields">
    <div class="form-group">
        <label for="currency">‡∏ó‡πà‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á:</label>
        <select id="POL" name="port_of_loading_id">
            <option value="">--select a port of loading--</option>
            {{range .Portofloadings}}<option value="{{.ID}}">{{.ThName}}</option>{{end}}
        </select>
    </div><br>

    <div class="form-group">
        <label for="currency">‡∏ó‡πà‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á:</label>
        <select id="POD" name="port_of_discharge_id">
            <option value="">--select a port of loading--</option>
            {{range .Portofdischarges}}<option value="{{.ID}}">{{.ThName}}</option>{{end}}
        </select>
    </div><br>
</div>

                <div class="form-group">
                <label for="first_delivery_date">‡∏ß‡∏±‡∏ô‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô:</label>
                <input type="date" id="first_delivery_date" name="first_delivery_date" required></div><br>
                
                <div class="form-group">
                <label for="last_delivery_date">‡∏ß‡∏±‡∏ô‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î:</label>
                <input type="date" id="last_delivery_date" name="last_delivery_date" required></div><br>
                
                <div class="form-group">
                <label for="remark">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ):</label>
                <input type="text" id="remark" name="remark"></div><br>
                

                <button type="button" onclick="generateConfirmation()">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á</button>
            </form>
            <div id="response"></div>
        </main>
    </div>

<div id="confirmationModal" class="modal" style="display:none;">
    <div class="modal-content" id="modal-content"></div>

</div>
    </div>
</body>
<footer>
    <br>
    <a href="/about?lang={{ .lang }}">‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤</a> | <a href="/faqs?lang={{ .lang }}">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢</a> | <a href="/contact?lang={{ .lang }}">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</a><br>
    <p>‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡πÑ‡∏ö‡πÇ‡∏≠‡πÅ‡∏°‡∏™ ‡πÄ‡∏≠‡πá‡∏Å‡∏ã‡πå‡πÄ‡∏ä‡∏ô‡∏à‡πå ‡∏à‡∏≥‡∏Å‡∏±‡∏î</p>
    <br>
</footer>
{{ end }}